<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Lesson_4(45, 46)</title>
</head>
<style>
    .description {
        width: 600px;
    }

    .view {
        width: 300px;
    }

    div {
        width: 200px;
    }

    table, th, td {
        padding: 10px;
        border: 1px solid;
        border-collapse: collapse;
    }
</style>
<body>
<h1>Введение в формат JSON в JavaScript</h1>
<table border="1">
    <tr>
        <td class="description">
            <p>Дан массив. Вручную преобразуйте этот массив в строку в формате JSON.</p>
        </td>
        <td colspan="2" class="view">
        </td>
    </tr>
    <tr>
        <td class="description">
            <p>Дан объект. Вручную преобразуйте этот массив в строку в формате JSON..</p>
        </td>
        <td colspan="2" class="view">
        </td>
    </tr>
    <tr>
        <td class="description">
            <p>Дан объект. Вручную преобразуйте этот массив в строку в формате JSON..</p>
        </td>
        <td colspan="2" class="view">
        </td>
    </tr>
</table>
<h1>Преобразование JSON в структуру данных JavaScript</h1>
<table border="1">
    <tr>
        <td class="description">
            <p>Дана строка в формате JSON, содержащая массив с числами: </p>
            <p>
                let json = '[1,2,3,4,5]';
            </p>
            <p>
                Преобразуйте эту строку в настоящий массив JavaScript и найдите сумму чисел этого массива.
            </p>
        </td>
        <td colspan="2" class="view" id="task_1">
        </td>
    </tr>
    <tr>
        <td class="description">
            <p>Дана строка в формате JSON, содержащая объект с данными: </p>
            <p>
                let json = `{
                "data1": [1,2,3],
                "data2": [4,5,6],
                "data3": [7,8,9]
                }`;
            </p>
            <p>
                Найдите сумму чисел из представленных данных.
            </p>
        </td>
        <td colspan="2" class="view" id="task_2">
        </td>
    </tr>
    <tr>
        <td class="description">
            <p>Дана строка в формате JSON, содержащая имена юзеров:
            <p>
                let json = '["user1","user2","user3","user4","user5"]'; </p>
            <p>
                Выведите эти имена в виде списка ul.
            </p>
        </td>
        <td colspan="2" class="view" id="task_3">
        </td>
    </tr>
    <tr>
        <td class="description">
            <p>Дана строка в формате JSON, содержащая массив с данными работников:</p>
            <p>
                let json = `[
                {
                "name": "user1",
                "age": 25,
                "salary": 1000
                },
                {
                "name": "user2",
                "age": 26,
                "salary": 2000
                },
                {
                "name": "user3",
                "age": 27,
                "salary": 3000
                }
                ]`;
            </p>
            <p>
                Выведите этих работников на экран в виде HTML таблицы.
            </p>
        </td>
        <td colspan="2" class="view" id="task_4">
        </td>
    </tr>
</table>
<script>
    "use strict";

    function IsJsonString(str) {
        try {
            JSON.parse(str);
        } catch (e) {
            return false;
        }
        return true;
    }

    let arr = [1, 2, 3, 'a', 'b', 'c'];
    let json = '[1, 2, 3, "a", "b", "c"]';
    console.log(IsJsonString(json));

    let obj = {
        a: 1,
        b: 2,
        c: 'eee',
        d: true,
    };
    json = '{"a": 1,' +
        '"b": 2,' +
        '"c": "eee",' +
        '"d": true' +
        '}';
    console.log(IsJsonString(json));

    obj = {
        a: ['a', 'b', 'c',],
        b: '111',
        c: 'eee',
    };
    json = '{' +
        '"a": ["a", "b", "c"],' +
        '"b": "111",' +
        '"c": "eee"' +
        '}';
    console.log(IsJsonString(json));

    json = '[1,2,3,4,5]';

    arr = JSON.parse(json);
    let p = document.createElement('p');
    let sum = 0;
    arr.forEach(el => sum += +el);
    p.textContent = sum;
    document.querySelector('#task_1').appendChild(p);

    json = `{
	"data1": [1,2,3],
	"data2": [4,5,6],
	"data3": [7,8,9]
	}`;
    sum = 0;
    obj = JSON.parse(json);
    for (let key in obj) {
        obj[key].forEach(value => sum += +value);
    }
    p = document.createElement('p');
    p.textContent = sum;
    document.querySelector('#task_2').appendChild(p);

    let ul = document.createElement('ul');
    json = '["user1","user2","user3","user4","user5"]';
    JSON.parse(json).forEach(user => {
        let li = document.createElement('li');
        li.textContent = user;
        ul.appendChild(li);
    });
    document.querySelector('#task_3').appendChild(ul);

    let table = document.createElement('table');
    json = `[
	{
		"name": "user1",
		"age": 25,
		"salary": 1000
	},
	{
		"name": "user2",
		"age": 26,
		"salary": 2000
	},
	{
		"name": "user3",
		"age": 27,
		"salary": 3000
	}
]`;
    for (let emp of JSON.parse(json)) {
        let td = document.createElement('td');
        for (let key in emp) {
            let li = document.createElement('li');
            li.textContent = emp[key];
            td.appendChild(li);
        }
        table.appendChild(td);
    }
    document.querySelector('#task_4').appendChild(table);

</script>
</body>
</html>